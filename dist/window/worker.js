const e="array",t="function",r="null",n="number",s="object",a="symbol",o="undefined",c="apply",l="construct",i="defineProperty",u="deleteProperty",f="get",p="getOwnPropertyDescriptor",y="getPrototypeOf",w="has",d="isExtensible",g="ownKeys",h="preventExtensions",v="set",E="setPrototypeOf";var b=Object.freeze({__proto__:null,APPLY:c,CONSTRUCT:l,DEFINE_PROPERTY:i,DELETE_PROPERTY:u,GET:f,GET_OWN_PROPERTY_DESCRIPTOR:p,GET_PROTOTYPE_OF:y,HAS:w,IS_EXTENSIBLE:d,OWN_KEYS:g,PREVENT_EXTENSION:h,SET:v,SET_PROTOTYPE_OF:E});function T(){return this}const m=new FinalizationRegistry((([e,t,r])=>{r&&console.debug(`Held value ${String(t)} not relevant anymore`),e(t)})),O=Object.create(null),{Object:P,Proxy:_,Reflect:k}=globalThis,{isArray:S}=Array,{ownKeys:A}=k,{create:R,hasOwn:x,values:M}=P,I=(r,n)=>n===e?r[0]:n===t?r():n===s?r.$:r,j=(e,t,r,n)=>{const s={type:{value:t}},a=x(e,"valueOf");for(const o of M(b)){let c=n(e[o]||k[o]);if(a&&o===f){const{valueOf:n}=e,{value:s}=c;c={value(e,a,...o){return a===r?n.call(this,I(e,t)):s.call(this,e,a,...o)}}}s[o]=c}return R(e,s)},$=(e,r,n,a=e)=>{if(a===e)switch(typeof e){case s:case t:case o:break;default:a=!1,r===e&&(r=P(e))}const c=new _(r,n),{destruct:l}=n;return l?((e,t,{debug:r,handler:n,return:s,token:a=e}=O)=>{const o=s||new Proxy(e,n||O),c=[o,[t,e,!!r]];return!1!==a&&c.push(a),m.register(...c),o})(e,l,{token:a,return:c}):c},N=t=>n=>{const a=typeof n;return a===s?n?t.get(n)||(S(n)?e:s):r:a},W=e=>((e=>{m.unregister(e)})(e),e);var Y=r=>{const n=new WeakMap,a=Symbol(),o={},c={proxy:o,release:W,typeOf:N(n),valueOf:e=>e[a]??e.valueOf()};for(const l of A(r)){if(x(c,l))continue;const i=r[l];switch(l){case e:{const e=j(i,l,a,(e=>({value([t],...r){return e.call(this,t,...r)}})));o[l]=(t,...r)=>$(t,[t],e,...r);break}case t:{const e=j(i,l,a,(e=>({value(t,...r){return e.call(this,t(),...r)}})));o[l]=(t,...r)=>{return $(t,(n=t,T.bind(n)),e,...r);var n};break}case s:{const e=j(i,l,a,(e=>({value({$:t},...r){return e.call(this,t,...r)}})));o[l]=(t,...r)=>$(t,{$:t},e,...r);break}default:{const e=j(i,l,a,(e=>({value:e})));o[l]=(t,...r)=>{const s=$(t,t,e,...r);return n.set(s,l),s};break}}}return c};let D=0;const L=new Map,B=new Map,C=e=>B.get(e),{ArrayBuffer:F,Atomics:U,Promise:z}=globalThis,{isArray:H}=Array,{create:G,getPrototypeOf:K,values:X}=Object,q=K(Int32Array),J=G(U),V=({currentTarget:e,type:t,origin:r,lastEventId:n,source:s,ports:a},o)=>e.dispatchEvent(new MessageEvent(t,{data:o,origin:r,lastEventId:n,source:s,ports:a})),Q=()=>z.withResolvers();let Z=0;const ee=new Map,te=(e,t)=>class extends e{constructor(e,...r){super(e,...r),e instanceof t&&ee.set(this,[Z++,0,Q()])}},re=new WeakSet,ne=e=>(re.add(e),e),se=(e,t)=>{const{data:r}=e,n=H(r)&&(r.at(0)===t||0===r.at(1)&&!t);return n&&(e.stopImmediatePropagation(),e.preventDefault()),n},ae=e=>null!==e&&"object"==typeof e&&!re.has(e),oe=new WeakMap,ce=(e,t,r)=>{if(ee.has(e))t.set(e,ee.get(e)[0]);else if(!(e instanceof q||e instanceof F))for(const n of X(e))ae(n)&&!r.has(n)&&(r.add(n),ce(n,t,r))},le=(...e)=>({value:new z((t=>{let r=new Worker("data:application/javascript,onmessage%3De%3D%3EpostMessage(!Atomics.wait(...e.data))");r.onmessage=()=>t("ok"),r.postMessage(e)}))}),ie=(e,t)=>{const r=ee.get(e),[n,s,{promise:a}]=r;return r[1]=t,[n,a]};let{BigInt64Array:ue,Int32Array:fe,SharedArrayBuffer:pe,addEventListener:ye,postMessage:we}=globalThis,de=!0,ge=e=>e,he=!1;const ve=Q();try{new pe(4),J.waitAsync||(J.waitAsync=le),ve.resolve()}catch(e){const t=we,r=ye,n=[];let s="",a="";pe=class extends F{},ue=te(ue,pe),fe=te(fe,pe),ge=ne,he=!0,J.notify=(e,r)=>{const[n]=(e=>oe.get(e))(e);return t([s,1,e,n,r]),0},J.waitAsync=(...e)=>{const[t,r]=ie(...e);return{value:r}},J.wait=(e,t,...r)=>{const[n]=ie(e,t,...r),o=new XMLHttpRequest;o.responseType="json",o.open("POST",`${a}?sabayon`,!1),o.setRequestHeader("Content-Type","application/json"),o.send(`["${s}",${n},${t}]`);const{response:c}=o;ee.delete(e);for(let t=0;t<c.length;t++)e[t]=c[t];return"ok"},r("message",(e=>{if(se(e,s)){const[t,r,...n]=e.data;switch(r){case 0:s=t,a=n.at(0)?.serviceWorker||"",a||(J.wait=null,ve.resolve());break;case 1:((e,t,r)=>{for(const[n,[s,a,{resolve:o}]]of ee)if(t===s&&r===a){for(let t=0;t<e.length;t++)n[t]=e[t];ee.delete(n),o("ok");break}})(...n);break;case 2:((e,t,r)=>{for(const[r,n]of t)oe.set(r,[n,e.currentTarget]);V(e,r)})(e,...n);break;case 3:ve.resolve()}}else if(de){const{currentTarget:t,type:r,origin:s,lastEventId:a,source:o,ports:c}=e;n.push([{currentTarget:t,type:r,origin:s,lastEventId:a,source:o,ports:c},e.data])}})),ye=(e,...t)=>{if(r(e,...t),n.length)for(const e of n.splice(0))V(...e)},we=(e,...r)=>t(((e,t)=>{const r=new Map;return ae(t)&&ce(t,r,new Set),r.size?[e,2,r,t]:t})(s,e),...r)}await ve.promise,de=!1;const{BYTES_PER_ELEMENT:Ee}=Int32Array,{BYTES_PER_ELEMENT:be}=Uint16Array,{notify:Te}=J,me=new TextDecoder("utf-16"),Oe=new WeakSet,Pe=(...e)=>(Oe.add(e),e);let _e="";const ke=new Map,Se=(e,t,r)=>{const[n]=r,s=t.get(n);if(!s)throw new Error(`Unknown proxy.${n}()`);e(s,r)};let Ae=0;const Re=(e,t)=>new Proxy(t,{get:(t,r)=>t.get(r)||t.set(r,(([e,t,r,n,s,a,o,c,l,i],u)=>(...f)=>{if(""!==_e)throw new Error(`ðŸ’€ðŸ”’ - proxy.${u}() deadlock in proxy.${_e}()`);const p=Ae++,y=[];Oe.has(f.at(-1)||y)&&Oe.delete(y=f.pop());const w=n(l?f.map(l):f);let d=new t(new r(2*Ee));return c([e,2,u,p,d,w,s],{transfer:y}),i(d,0).value.then((()=>{const n=d[1];if(!n)return;const s=be*n;return d=new t(new r(s+s%Ee)),c([e,1,p,d]),i(d,0).value.then((()=>{const e=new Uint16Array(d.buffer),t=o?e.subarray(0,n):e.slice(0,n);return a(me.decode(t))}))}))})(e,r)).get(r),set:(e,t,r)=>!!e.set(t,r)}),{wait:xe,waitAsync:Me}=J;var Ie=({interrupt:e,parse:t,stringify:r,transform:n}=JSON)=>{const s=((e,t)=>async(r,[n,s,a,o,c])=>{c&&(_e=n);try{const n=await r(...o);if(void 0!==n){const r=e(t?t(n):n);ke.set(s,r),a[1]=r.length}}finally{c&&(_e=""),a[0]=1,Te(a,0)}})(r,n),a=Q(),o=new Map;let c="",l=xe;if(xe&&e){const{handler:t,timeout:r=42}=e;l=(e,n,s)=>{for(;"timed-out"===(s=xe(e,n,0,r));)t();return s}}return ye("message",(e=>{if(se(e,c)){const[r,i,...u]=e.data;switch(i){case 0:c=r,a.resolve({transfer:Pe,proxy:Re([c,fe,pe,ge,!!xe,t,he,we,n,xe?(...e)=>({value:{then:t=>t(l(...e))}}):Me],o)});break;case 2:o.size?Se(s,o,u):setTimeout(Se,0,s,o,u);break;case 1:((e,t)=>{const r=ke.get(e);ke.delete(e);for(let e=new Uint16Array(t.buffer),n=0,{length:s}=r;n<s;n++)e[n]=r.charCodeAt(n);Te(t,0)})(...u)}}})),a.promise},je=Object.fromEntries([e,"bigint","boolean",t,r,n,s,"string",a,o].map(((e,t)=>[e,t])));const $e="destruct",Ne="valueOf",{[g]:We}=Reflect,Ye=new Map(We(Symbol).filter((e=>typeof Symbol[e]===a)).map((e=>[Symbol[e],e]))),De=e=>Ye.get(e)||`.${Symbol.keyFor(e)||""}`,Le="\0__main__\0",{[c]:Be}=Reflect;var Ce=async r=>{const o=await Ie(r),b=r?.transform||(e=>e),{[Le]:T}=o.proxy,m=new Map,O=(e,t)=>{let r=m.get(e)?.deref();return r||m.set(e,new WeakRef(r=t(e))),r},P=([r,o])=>{switch(r){case je[s]:return null==o?globalThis:typeof o===n?O(o,A.object):o;case je[e]:return typeof o===n?O(o,A.array):o;case je[t]:return typeof o===n?O(o,A.function):C(parseInt(o));case je[a]:return(e=>{if(e.startsWith("."))return Symbol.for(e.slice(1));for(const[t,r]of Ye)if(r===e)return t})(o);default:return o}},_=r=>{const o=R(r);switch(o){case s:{let e=r;if(r===globalThis||null==r)e=null;else if(!(r instanceof q)&&(e=x(b(r)),typeof e===s))for(const t in e)e[t]=_(e[t]);return[je[s],e]}case e:{let t=x(b(r));return[je[e],typeof t===n?t:t.map(_)]}case t:{let e=x(b(r));return typeof e===t&&(e=String((e=>{if(!L.has(e)){let t;for(;B.has(t=D++););L.set(e,t),B.set(t,e)}return L.get(e)})(e))),[je[t],e]}case a:return[je[a],De(r)];default:return[je[o],r]}},k=(...e)=>P(T(...e)),S={[i]:(e,t,r)=>k(i,e,_(t),_(r)),[u]:(e,t)=>k(u,e,_(t)),[y]:e=>k(y,e),[f]:(e,t)=>k(f,e,_(t)),[p]:(e,t)=>{const r=k(p,e,_(t));if(r){const{get:e,set:t,value:n}=r;e&&(r.get=P(e)),t&&(r.set=P(t)),n&&(r.value=P(n))}return r},[w]:(e,t)=>k(w,e,_(t)),[d]:e=>k(d,e),[g]:e=>k(g,e).map(P),[h]:e=>k(h,e),[v]:(e,t,r)=>k(v,e,_(t),_(r)),[E]:(e,t)=>k(E,e,_(t)),[Ne]:e=>e,[$e](e){m.delete(e),T($e,e)}},{proxy:A,typeOf:R,valueOf:x}=Y({object:S,array:S,function:{...S,[c]:(e,...t)=>k(c,e,...t.map(_)),[l]:(e,...t)=>k(l,e,...t.map(_))}}),M=A.object(null);return o.proxy["\0__worker__\0"]=(e,t,...r)=>{const s=parseInt(t);switch(e){case c:return _(Be(C(s),...r.map(P)));case $e:return(e=>{const[t,r]=typeof e===n?[B,L]:[L,B],s=t.has(e);return s&&(r.delete(t.get(e)),t.delete(e)),s})(s)}},{...o,window:M,isWindowProxy:e=>x(e)!==e}};export{Ce as default};
